# 技术选型指南

## 词汇说明

本文中提及的 "软件" 是个泛指词汇，包括：狭义的封装软件、二进制库/框架、源码库/框架、范例程序等。
本文中提及的 "库" 是个泛指词汇，包括函数/算法库、框架、代码片段集等

## 主要指标 —— 法务（必要条件）

1. 必须有明确的授权文件
1. 对于开源软件的授权协议，参考下列决策树：

    ![开源授权协议决策树](./images/open-source-licenses.jpg)
    
1. 对于GPL，请确认是否愿意承担衍生开源的义务
1. 如果开源软件附加了专利条款（特别是Facebook的各种库），务必得到法务部门的认可

## 主要指标 —— 安全（必要条件）

1. 官方文档中是否有明确的安全指南和注意事项？
1. 是否有顺畅的安全漏洞举报渠道？
1. 尚未修复的已知漏洞是否对你们的业务场景有害？
1. 安全漏洞的修复周期有多久？（说明维护者是否有安全意识）
1. 代码总体质量如何？
    1. 主观感觉是否凌乱？
    1. 测试覆盖率如何？
    1. 抽检：是否有对参数进行有效性检查？
    1. 抽检：（前端）是否有直接设置innerHTML或通过jQuery直接设置html的代码？它们有没有进行安全检查？
1. 用常用的安全探测工具进行检测。
1. 如果公司政策中要求对第三方库进行集中式审核，则需考虑排队成本。如果审核时间较长，则应该优先选用成套解决方案，而不是用一大堆第三方库去组合。

## 主要指标 —— 人

### 维护者（作者团队）

1. 单位特性投入 = 特性范围（Scope） / 主要维护者数量。这个指标可以体现软件将来可预期的支持力度，体现其长久生命力。
1. 主要维护者的资历、声望。这个指标可以体现软件本身的质量以及社区感召力。
1. 主要维护者的专注程度。对于需要长久维护的软件，维护者的专注程度至关重要，如果从其表现看出他们能安心做技术才能给使用者信心。
1. 主要维护者的数量。维护者数量少意味着单点失效的风险高，对于风险敏感度较高的系统，应该避免使用维护者数量较少的技术。
1. 维护者对社区issue的重视程度和解决速度。

### 使用者（我方团队）

1. 技术背景。如果候选技术契合团队的技术背景，那么可以优先选用。注意，技术背景要以团队中的中高级成员为基准，不要以新手为基准。
1. 人员流动率。如果人员流动率高甚至没有长期培养计划，则优先选择简单易学的技术，否则优先选择成长空间较大的技术。
1. 团队结构。如果希望建立结构良好的人才梯队，则优先选择具有较明确的初、中、高级阶段，且高级阶段能达到一定高度的技术。

### 社区

1. 技术氛围。好的社区应该更专注于完善软件本身。
1. 人才结构。如果新手过多，可能导致企业招人时的筛选成本过高，并最终伤害社区；如果新手区太舒适，则会缺乏中级人才，并最终导致高级人才匮乏。参考 ".net悲剧" 。
1. 原创氛围。创新是软件的生命和核心价值。良好的社区应该更热衷于原创，而不是追赶、模仿。

## 主要指标 —— 业务需求

### 需求规模

1. 网站地图。一个简单的估算指标是路由数量（独立URL路径）。这种复杂度通常无法通过拆成子项目来避免。
1. 复杂度。分支数量、异常情况处理等方面的要求有多高？复杂度越高则需要能力越强的库。轻量级的库往往需要自身有能力很强的架构师才能驾驭。
1. 成长性。在目前的最小化需求和最终的需求之间，从业务上能否明确划分出几个清晰的阶段？库本身是否能随之演化到最终阶段，而不需要大幅修改？
1. 契合度。小需求用大型库或者大需求用小型库通常不会是最佳选择，但一些设计良好的大型库是例外，它可能适用于各种情况。只要具有良好的模块化设计，那么大型库仍然可以当做一组小型库使用，并产生良好的协同效应，有利于长久维护，会比一组小型库更好。

### 需求重点

1. 面向不特定人群的消费级软件通常在兼容性、流畅度、延展性等方面要求较高。
1. 面向特定人群的企业级软件通常在扩展性、健壮性等方面要求较高。
1. 预期将长期维护的软件通常在扩展性方面要求较高。
1. 预期生命周期较短的软件通常以 "有哪些可复用资源" 为主要考虑。
1. 任何软件都有例外，去跟业务方确定真实的重点需求。

### 需求稳定度

1. 对于需求变化频繁或生命周期很长的项目，应该优先选择可维护性强的技术，特别是：是否支持各种层次的测试、是否支持静态类型语法、架构是否清晰、是否有得到社区公认并遵循的风格指南等。
1. 对于 "未知或待定需求" 较多的项目，应该优先选择可以自行修改、扩展的技术，特别是：优先选择代码质量较高、团队的高级成员能大致读懂的库。具体参见 "技术" 部分。宁可选择高质量的大型软件和小型软件，也不要选择低质量的、看似满足了所有需求的大型软件。

## 主要指标 —— 技术

### 版本控制

1. 是否承诺并切实遵循了语义化版本规范（semver），候选库严格遵循它可以让使用者的升级成本最低。
1. 是否具有清晰的提交记录和规范，特别是：要有明确的提交说明规范，不要有超大型提交。
1. 是否具有配套的 CI，近期的CI常绿记录有多少？

### 代码质量

1. 测试覆盖率有多高？
1. 架构是否合理？
1. 是否具有统一的代码风格？
1. 代码是否干净？参见《Clean code》。
1. 技术栈是否现代？过时的技术栈会逐步退出舞台，招人会越来越难。

### 创新

1. 有哪些独创技术？这些是吸引高端人才、提升社区档次的关键。
1. 对你的哪些痛点有简单、新颖的解决方案？这可以证明维护者及社区的能力。


